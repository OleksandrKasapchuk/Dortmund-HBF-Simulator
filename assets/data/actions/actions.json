{
  "baryga_buy_grass": { "type": "trade", "from": "money", "to": "grass", "fromAmount": 10, "toAmount": 1 },
  "kioskman_buy_pape": { "type": "trade", "from": "money", "to": "pape", "fromAmount": 5, "toAmount": 1 },
  "kioskman_buy_icetea": { "type": "trade", "from": "money", "to": "ice_tea", "fromAmount": 10, "toAmount": 1 },
  "buy_seed": { "type": "trade", "from": "money", "to": "grass_seed", "fromAmount": 5, "toAmount": 1 },

  "murat_accept_quest": { "type": "add_quest", "id": "chili"},
  "walter_accept_quest": { "type": "add_quest", "id": "wallet"},
  "igo_add_quest": { "type": "add_quest", "id": "igo" },

  "ryzhyi_take_money": {
    "type": "composite",
    "actions": [
      { "type": "add_item", "id": "money", "amount": 20 },
      { "type": "set_dialogue", "npc": "ryzhyi", "node": "money.completed" }
    ]
  },

  "jason_give_money": {
    "type": "composite",
    "actions": [
      { "type": "add_item", "id": "money", "amount": 20 },
      { "type": "add_quest", "id": "jason1"},
      { "type": "add_quest", "id": "jason2"},
      { "type": "set_dialogue", "npc": "jason", "node": "tour.active" }
    ]
  },
  "jason_completed": {
    "type": "composite",
    "actions": [
      { "type": "set_dialogue", "npc": "jason", "node": "tour.completed" }
    ]
  },

  "igo_give_vape": {
    "type": "conditional_trade",
    "from": "joint",
    "to": "vape",
    "fromAmount": 1,
    "toAmount": 1,
    "onSuccess": {
      "type": "composite",
      "actions": [
        { "type": "set_dialogue", "npc": "igo", "node": "vape.completed" },
        { "type": "play_sound", "id": "lighter" },
        {
          "type": "timer",
          "delay": 5.0,
          "action": {
            "type": "set_texture",
            "npc": "igo",
            "texture": "igo2"
          }
        }
      ]
    }
  },

  "give_vape_action": {
    "type": "if_has_item",
    "itemId": "vape",
    "item": "vape",
    "action": {
      "type": "set_dialogue",
      "npc": "talahon2",
      "node": "vape.completed"
    }
  },

  "boss_accept_quest": {
    "type": "composite",
    "actions": [
      { "type": "add_item", "id": "grass", "amount": 1000 },
      { "type": "add_quest", "id": "delivery"},
      { "type": "set_dialogue", "npc": "boss", "node": "delivery.active" }
    ]
  },

  "boss_claim_reward": {
    "type": "composite",
    "actions": [
      { "type": "add_item", "id": "money", "amount": 50 },
      { "type": "set_dialogue", "npc": "boss", "node": "idle" },
      { "type": "complete_quest", "id": "boss_end" }
    ]
  },

  "pfand_automat_interact": {
    "type": "if_has_item",
    "itemId": "pfand",
    "amount": 1,
    "action": "pfand_success",
    "onFail": { "type": "not_enough_message", "item": "pfand" }
  },

  "pfand_success": {
    "type": "composite",
    "actions": [
      { "type": "remove_item", "id": "pfand", "amount": 1 },
      { "type": "play_sound", "id": "pfandAutomat" },
      { "type": "start_cooldown", "id": "pfandAutomat", "seconds": 1.9 },
      {
        "type": "timer",
        "delay": 1.9,
        "action": { "type": "add_item", "id": "money", "amount": 1 }
      }
    ]
  },

  "table_plant_grass": {
    "type": "if_has_item",
    "itemId": "grass_seed",
    "amount": 1,
    "action": "table_success",
    "onFail": { "type": "not_enough_message", "item": "grass_seed" }
  },

  "table_success": {
    "type": "composite",
    "actions": [
      { "type": "remove_item", "id": "grass_seed", "amount": 1 },
      { "type": "play_sound", "id": "bush" },
      {
        "type": "timer",
        "delay": 1.9,
        "action": { "type": "message", "text": "message.grass_planted", "duration": 1.0 }
      }
    ]
  },

  "bush_interaction": {
    "type": "if_has_item",
    "itemId": "grass",
    "amount": 1000,
    "action": "bush_success",
    "onFail": { "type": "not_enough_message", "item": "grass" }
  },

  "bush_success": {
    "type": "composite",
    "actions": [
      { "type": "complete_quest", "id": "delivery" },
      { "type": "remove_item", "id": "grass", "amount": 1000 },
      { "type": "play_sound", "id": "bush" },
      {
        "type": "timer",
        "delay": 2.0,
        "action": {
          "type": "composite",
          "actions": [
            { "type":  "call_police"},
            { "type": "set_dialogue", "npc": "summoned_police", "node": "chase.offer" },
            { "type": "force_dialogue", "npc": "summoned_police" }
          ]
        }
      }
    ]
  },

  "handle_boss_fail": {
    "type": "composite",
    "actions": [
      { "type": "set_dialogue", "npc": "boss", "node": "delivery.failed" },
      { "type": "remove_npc", "npc": "boss" },
      {
        "type": "timer",
        "delay": 2.0,
        "action": {
          "type": "composite",
          "actions": [
            { "type": "spawn_npc_near_player", "npc": "boss", "offsetX": -100 },
            { "type": "force_dialogue", "npc": "boss" }
          ]
        }
      }
    ]
  },

  "failure": {
    "type": "composite",
    "actions": [
      { "type": "player_died" },
      { "type": "play_sound", "id": "gunShot" }
    ]
  },

  "chikita_craft_joint": { "type": "chikita_craft" },
  "player_died": { "type": "player_died" },
  "police_check": { "type": "police_check" },

  "player_stoned": {
    "type": "composite",
    "actions": [
      { "type": "play_music", "id": "backMusic" },
      { "type": "set_dialogue", "npc": "police", "node": "check.failed" },
      { "type": "message", "key": "message.joint", "duration": 1.5 }
    ]
  },

  "player_normal": {
    "type": "composite",
    "actions": [
      { "type": "play_music", "id": "back1" },
      { "type": "set_dialogue", "npc": "police", "node": "check.active" },
      { "type": "message", "key": "message.ice_tea", "duration": 1.5 }
    ]
  },

  "applyJoint": {
    "type": "composite",
    "actions": [
      { "type": "play_sound", "id": "lighter" },
      { "type": "timer", "delay": 4.0, "action": { "type": "player.set_state", "key": "stoned" } }
    ]
  },

  "applyIceTea": {
    "type": "timer", "delay": 1.0, "action": { "type": "player.set_state", "key": "normal" }
  },

  "start_police_chase": {
    "type": "composite",
    "actions": [
      { "type":  "add_quest", "id": "chase"},
      { "type":  "message", "key": "message.boss.chase.run", "duration": 2 },
      { "type":  "play_music", "id": "back4" },
      { "type": "set_dialogue", "npc":  "summoned_police", "node": "chase.failed"},
      { "type": "start_chase"}
    ]
  },

  "police_caught": {"type": "force_dialogue", "npc": "summoned_police"},

  "police_escaped": {
    "type": "composite",
    "actions": [
      { "type": "play_music", "id": "back1" },
      { "type": "message", "key": "message.generic.ranAway", "duration": 1.5 },
      { "type": "set_dialogue", "npc": "boss", "node": "chase.completed" },
      { "type": "complete_quest", "id": "chase" },
      { "type": "add_quest", "id": "boss_end"},
      { "type": "remove_npc", "npc": "summoned_police" }
    ]
  },

  "restore_chase_ui": {
    "type": "composite",
    "actions": [
      { "type": "play_music", "id": "back4" },
      { "type": "set_dialogue", "npc": "summoned_police", "node": "chase.failed"}
    ]
  },

  "jan_give_quest": {
    "type": "composite",
    "actions": [
      { "type": "set_dialogue", "npc": "jan", "node": "fireworks.active" },
      { "type": "add_quest", "id": "jan", "progressable": true, "progress": 0, "max": 2 }
    ]
  },

  "jan_complete": {
    "type": "composite",
    "actions": [
      { "type": "set_dialogue", "npc": "jan", "node": "fireworks.completed" },
      { "type": "add_quest", "id": "jan2"}
      ]
  }
}
