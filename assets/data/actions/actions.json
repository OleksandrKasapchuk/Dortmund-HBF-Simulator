{
  "inventory.baryga_buy_grass": { "type": "inventory.trade", "from": "money", "to": "grass", "fromAmount": 10, "toAmount": 1 },
  "inventory.kioskman_buy_pape": { "type": "inventory.trade", "from": "money", "to": "pape", "fromAmount": 5, "toAmount": 1 },
  "inventory.kioskman_buy_icetea": { "type": "inventory.trade", "from": "money", "to": "ice_tea", "fromAmount": 10, "toAmount": 1 },
  "inventory.buy_seed": { "type": "inventory.trade", "from": "money", "to": "grass_seed", "fromAmount": 5, "toAmount": 1 },

  "quest.murat.accept": { "type": "quest.start", "id": "chili"},
  "quest.walter.accept": { "type": "quest.start", "id": "wallet"},
  "quest.igo.add": { "type": "quest.start", "id": "igo" },

  "npc.ryzhyi.take_money": {
    "type": "system.composite",
    "actions": [
      { "type": "inventory.add", "id": "money", "amount": 20 },
      { "type": "dialogue.set", "npc": "ryzhyi", "node": "money.completed" }
    ]
  },

  "npc.jason.give_money": {
    "type": "system.composite",
    "actions": [
      { "type": "inventory.add", "id": "money", "amount": 20 },
      { "type": "quest.start", "id": "jason1"},
      { "type": "quest.start", "id": "jason2"},
      { "type": "dialogue.set", "npc": "jason", "node": "tour.active" }
    ]
  },
  "quest.jason.complete": {
    "type": "system.composite",
    "actions": [
      { "type": "dialogue.set", "npc": "jason", "node": "tour.completed" }
    ]
  },

  "npc.igo.give_vape": {
    "type": "inventory.conditionalTrade",
    "from": "joint",
    "to": "vape",
    "fromAmount": 1,
    "toAmount": 1,
    "onSuccess": {
      "type": "system.composite",
      "actions": [
        { "type": "dialogue.set", "npc": "igo", "node": "vape.completed" },
        { "type": "audio.playSound", "id": "lighter" },
        {
          "type": "system.timer",
          "delay": 5.0,
          "action": {
            "type": "npc.setTexture",
            "npc": "igo",
            "texture": "igo2"
          }
        }
      ]
    }
  },

  "npc.talahon2.give_vape": {
    "type": "inventory.check",
    "itemId": "vape",
    "item": "vape",
    "action": {
      "type": "dialogue.set",
      "npc": "talahon2",
      "node": "vape.completed"
    }
  },

  "quest.delivery.accept": {
    "type": "system.composite",
    "actions": [
      { "type": "inventory.add", "id": "grass", "amount": 1000 },
      { "type": "quest.start", "id": "delivery"},
      { "type": "dialogue.set", "npc": "boss", "node": "delivery.active" }
    ]
  },

  "quest.boss_end.claim_reward": {
    "type": "system.composite",
    "actions": [
      { "type": "inventory.add", "id": "money", "amount": 50 },
      { "type": "dialogue.set", "npc": "boss", "node": "idle" },
      { "type": "quest.complete", "id": "boss_end" }
    ]
  },

  "interact.pfand_automat": {
    "type": "inventory.check",
    "itemId": "pfand",
    "amount": 1,
    "action": "interact.pfand_automat.success",
    "onFail": { "type": "ui.notEnoughMessage", "item": "pfand" }
  },

  "interact.pfand_automat.success": {
    "type": "system.composite",
    "actions": [
      { "type": "inventory.remove", "id": "pfand", "amount": 1 },
      { "type": "audio.playSound", "id": "pfandAutomat" },
      { "type": "item.startCooldown", "id": "pfandAutomat", "seconds": 1.9 },
      {
        "type": "system.timer",
        "delay": 1.9,
        "action": { "type": "inventory.add", "id": "money", "amount": 1 }
      }
    ]
  },

  "interact.table_plant": {
    "type": "inventory.check",
    "itemId": "grass_seed",
    "amount": 1,
    "action": "interact.table_plant.success",
    "onFail": { "type": "ui.notEnoughMessage", "item": "grass_seed" }
  },

  "interact.table_plant.success": {
    "type": "system.composite",
    "actions": [
      { "type": "inventory.remove", "id": "grass_seed", "amount": 1 },
      { "type": "audio.playSound", "id": "bush" },
      {
        "type": "system.timer",
        "delay": 1.9,
        "action": { "type": "ui.message", "key": "message.grass_planted", "duration": 1.0 }
      }
    ]
  },

  "quest.delivery.interact_bush": {
    "type": "inventory.check",
    "itemId": "grass",
    "amount": 1000,
    "action": "quest.delivery.complete",
    "onFail": { "type": "ui.notEnoughMessage", "item": "grass" }
  },

  "quest.delivery.complete": {
    "type": "system.composite",
    "actions": [
      { "type": "quest.complete", "id": "delivery" },
      { "type": "inventory.remove", "id": "grass", "amount": 1000 },
      { "type": "audio.playSound", "id": "bush" },
      {
        "type": "system.timer",
        "delay": 2.0,
        "action": {
          "type": "system.composite",
          "actions": [
            { "type":  "npc.callPolice"},
            { "type": "dialogue.set", "npc": "summoned_police", "node": "chase.offer" },
            { "type": "dialogue.force", "npc": "summoned_police" }
          ]
        }
      }
    ]
  },

  "quest.delivery.fail": {
    "type": "system.composite",
    "actions": [
      { "type": "dialogue.set", "npc": "boss", "node": "delivery.failed" },
      { "type": "npc.remove", "npc": "boss" },
      {
        "type": "system.timer",
        "delay": 2.0,
        "action": {
          "type": "system.composite",
          "actions": [
            { "type": "npc.spawnNearPlayer", "npc": "boss", "offsetX": -100 },
            { "type": "dialogue.force", "npc": "boss" }
          ]
        }
      }
    ]
  },

  "player.state.stoned.enter": {
    "type": "system.composite",
    "actions": [
      { "type": "audio.playMusic", "id": "kaif" },
      { "type": "dialogue.set", "npc": "police", "node": "check.failed" },
      { "type": "ui.message", "key": "message.joint", "duration": 1.5 }
    ]
  },

  "player.state.normal.enter": {
    "type": "system.composite",
    "actions": [
      { "type": "audio.playMusic", "id": "back1" },
      { "type": "dialogue.set", "npc": "police", "node": "check.active" },
      { "type": "ui.message", "key": "message.ice_tea", "duration": 1.5 }
    ]
  },

  "item.joint.use": {
    "type": "system.composite",
    "actions": [
      { "type": "audio.playSound", "id": "lighter" },
      { "type": "system.timer", "delay": 4.0, "action": { "type": "player.setState", "key": "stoned" } }
    ]
  },

  "item.ice_tea.use": {
    "type": "system.timer", "delay": 1.0, "action": { "type": "player.setState", "key": "normal" }
  },

  "quest.chase.start": {
    "type": "system.composite",
    "actions": [
      { "type":  "quest.start", "id": "chase"},
      { "type":  "ui.message", "key": "message.boss.chase.run", "duration": 2 },
      { "type":  "audio.playMusic", "id": "back2" },
      { "type": "dialogue.set", "npc":  "summoned_police", "node": "chase.failed"},
      { "type": "custom.startChase"}
    ]
  },

  "quest.chase.complete": {
    "type": "system.composite",
    "actions": [
      { "type": "audio.playMusic", "id": "back1" },
      { "type": "ui.message", "key": "message.generic.ranAway", "duration": 1.5 },
      { "type": "dialogue.set", "npc": "boss", "node": "chase.completed" },
      { "type": "quest.complete", "id": "chase" },
      { "type": "quest.start", "id": "boss_end"},
      { "type": "npc.remove", "npc": "summoned_police" }
    ]
  },

  "quest.chase.restore_ui": {
    "type": "system.composite",
    "actions": [
      { "type": "audio.playMusic", "id": "back2" },
      { "type": "dialogue.set", "npc": "summoned_police", "node": "chase.failed"}
    ]
  },

  "quest.jan.accept": {
    "type": "system.composite",
    "actions": [
      { "type": "dialogue.set", "npc": "jan", "node": "fireworks.active" },
      { "type": "quest.start", "id": "jan_firework", "progressable": true, "progress": 0, "max": 2 }
    ]
  },

  "quest.jan.complete": {
    "type": "system.composite",
    "actions": [
      { "type": "dialogue.set", "npc": "jan", "node": "fireworks.completed" },
      { "type": "quest.start", "id": "jan2"}
      ]
  },

  "player.die": {
    "type": "system.composite",
    "actions": [
      { "type": "audio.playSound", "id": "gunShot" },
      { "type": "player.die" }
    ]
  },

  "npc.police.check": {
    "type": "inventory.check",
    "items": ["grass", "joint", "vape"],
    "onSuccess": {
      "type": "system.composite",
      "actions": [
        { "type": "inventory.remove", "items": ["grass", "joint", "vape"], "amount": 9999 },
        { "type": "ui.message", "key": "message.police.stuffLost" }
      ]
    },
    "onFail": {"type": "ui.message", "key": "message.police.checkPassed"}
  },

  "npc.chikita.craft": {
    "type": "inventory.check", "itemId": "grass",
    "onFail": { "type": "ui.notEnoughMessage", "item": "grass" },
    "action": {
      "type": "inventory.check", "itemId": "pape",
      "onFail": { "type": "ui.notEnoughMessage", "item": "pape" },
      "action": {
        "type": "system.composite",
        "actions": [
          { "type": "inventory.remove", "id": "grass" },
          { "type": "inventory.remove", "id": "pape" },
          { "type": "player.lockMovement", "locked": true },
          { "type": "audio.playSound", "id": "kosyak" },
          {
            "type": "system.timer", "delay": 1.0,
            "action": {
              "type": "system.composite",
              "actions": [
                { "type": "inventory.add", "id": "joint" },
                { "type": "player.lockMovement", "locked": false }
              ]
            }
          }
        ]
      }
    }
  },
  "npc.summoned_police.force_dialogue": { "type": "dialogue.force", "npc": "summoned_police" },

  "item.search.basic": {
    "type": "system.composite",
    "actions": [
      { "type": "audio.playSound", "id": "search" },
      { "type": "player.lockMovement", "locked": true },
      {
        "type": "system.timer",
        "delay": 2.0,
        "action": {
          "type": "system.composite",
          "actions": [
            { "type": "player.lockMovement", "locked": false }
          ]
        }
      }
    ]
  }
}
